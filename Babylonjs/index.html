<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, shrink-to-fit=no,initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <title>顺达重矿</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="control.css" />
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <style>
      html,
      body {
        overflow: hidden;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }

      #renderCanvas {
        width: 100%;
        height: 100%;
        touch-action: none;
        /* background-image: url("./textures/sebastian-pichler-ly2T4vul_SE-unsplash.jpg"); */
        background-image: linear-gradient(to bottom, #535353 0%, #0e0e0e 100%);
        background-repeat: no-repeat;
        background-position: center;
        background-size: auto auto;
      }
      #scene-explorer-host,
      #inspector-host {
        z-index: 50;
      }

      .UITest {
        position: fixed;
        z-index: 1;
        width: 100%;
        touch-action: none;
        pointer-events: none;
      }

      .UITest img {
        width: 100%;
      }
    </style>
    <script type="text/javascript">
      try {
        if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
          window.location.href = "./mobile/index.html";
        }
      } catch (e) {}
    </script>
    <script src="animation/player/lottie.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="script/babylon.js"></script>
    <script src="script/babylon.gui.min.js"></script>
    <script src="script/babylonjs.loaders.min.js"></script>
    <script src="script/pep.js"></script>
    <script src="script/babylon.shadowOnlyMaterial.min.js"></script>
    <script src="script/babylon.inspector.bundle.js"></script>
  </head>
  <body>
    <!-- <div class="UITest"><img src="./textures/UI.png" alt=""></div> -->
    <iframe
      id="ifr"
      name="indexIfr"
      width="100%"
      height="100%"
      class="iframe"
      frameborder="0"
      marginheight="0"
      marginwidth="0"
      src="./index/index.html"
    ></iframe>

    <canvas id="renderCanvas"></canvas>
    <script src="script/main.js"></script>
    <div id="loadingScreen_Container">
      <div class="loadingLogo">
        <div class="companyLogo"><img src="ui/logo.png" /></div>
        <div class="progressBar-container">
          <div class="progressBar"></div>
        </div>
      </div>
    </div>
    <div id="initPageButton" class="buttom-box" hidden = true >
      <div class="leftbtn">

        <div id="imageIntroductionBox" class="image-introduction-box">
          <!-- <div class="image-introduction-bg" style="width: 100%; height: 50px; visibility:hidden;  background-color: #d50000;  mix-blend-mode: color;"> </div> -->
          <img  src="./ui/pic/redbg.png" class="image-introduction-bg"></img>
          <img  id="imgId" src="./ui/pic/A1.png" class="image-introduction"> </img>
          <!-- </div> -->
        </div>

      </div>
      <div class="rightbtn">
        <div class="color-box">
        <div
          class="btncss btnsize"
          id="colorbtn1"
          onclick="mouseup('color','colorbtn1')"
        ></div>
        <div
          class="btncss btnsize"
          id="colorbtn2"
          onclick="mouseup('color','colorbtn2')"
        ></div>
        <div
          class="btncss btnsize"
          id="colorbtn3"
          onclick="mouseup('color','colorbtn3')"
        ></div>
        </div>

        <div class="carousel-box">
          <div
            id="myCarousel"
            class="carousel slide "
            data-ride="carousel"
          >
            <!-- 指示符 -->
            <ul class="carousel-indicators">
              <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
              <li data-target="#myCarousel" data-slide-to="1"></li>
              <li data-target="#myCarousel" data-slide-to="2"></li>
              <li data-target="#myCarousel" data-slide-to="3"></li>
            </ul>
  
            <!-- 轮播图片 -->
            <div class="carousel-inner">
              <div class="carousel-item active">
                <!-- <div style="width: 300px; height: 100px"></div> -->
                <div style="width: 400px; height: 64px;"></div>
              </div>
              <div class="carousel-item">
                <div style="width: 400px; height: 64px;"></div>
              </div>
              <div class="carousel-item">
                <div style="width: 400px; height: 64px;"></div>
              </div>
              <div class="carousel-item">
                <div style="width: 400px; height: 64px;"></div>
              </div>
            </div>
  
            <!-- 左右切换按钮 -->
            <a
              class="carousel-control-prev"
              href="#myCarousel"
              data-slide="prev"
            >
              <span class="carousel-control-prev-icon"></span>
            </a>
            <a
              class="carousel-control-next"
          
              href="#myCarousel"
              data-slide="next"
            >
              <span class="carousel-control-next-icon"></span>
            </a>
          </div>
        </div>
         <div class="change-box">

        <div id="modelbtn1">
          <div
            class="btncss modelbtnsize "
            onclick="mouseup('model','modelbtn1');clickEvent(1);"
          >
        <img id="icon1" src="./ui/pic/l1.png" alt="">
        </div>
        </div>
        <div id="modelbtn2">
          <div
            class="btncss modelbtnsize "
            onclick="mouseup('model','modelbtn2');clickEvent(2);"
          >
          <img id="icon2" style="mask: red;" src="./ui/pic/l2.png" alt="">
        </div>
        </div>
        <div id="modelbtn3">
          <div
            class="btncss modelbtnsize "
            onclick="mouseup('model','modelbtn3');clickEvent(3);"
          >
          <img id="icon3" src="./ui/pic/l3.png" alt="">
        </div>
        </div>

         </div>
      </div>
    </div>
    <div class="buttombox">
      <!-- <div style="width: 300px;height: 200px;  background-color: #d50000;  mix-blend-mode: color;"></div> -->

    </div>
    <!-- <div class="buttom-box">
      <div
        class="btn buttom-btnsize btnposi"
        id="displaybtn1"
        onclick="mouseup('display','displaybtn1')"
      ></div>
    </div> -->
  </body>
  <script>


        
    let nextModelNum = 0;
    let currentModelNum  = nextModelNum; 
    let modelIntroImgPath=[["ui/pic/A1.png","ui/pic/A2.png","ui/pic/A3.png"],["ui/pic/B1.png","ui/pic/B2.png","ui/pic/B3.png"],["ui/pic/C1.png","ui/pic/C2.png","ui/pic/C3.png"]];
    let imgpath=["ui/pic/A1.png","ui/pic/A2.png","ui/pic/A3.png"]
    let iconpath=["ui/pic/l1.png","ui/pic/l2.png","ui/pic/l3.png"]
    let icon2path=["ui/pic/lr1.png","ui/pic/lr2.png","ui/pic/lr3.png"]
    $(".carousel").carousel({
      interval: false,
      keyboard: false,
      wrap: false,
    });
 
   $('#myCarousel').on('slid.bs.carousel', function (event) {
    checkitem()
    changeImgSrc(event.to)
    if(event.from==3 && event.to==2){
      let ZhiShaJi_aoTexture = new BABYLON.Texture("model/SheBei/ZhiShaJi_Ao2.jpg", scene);
      hotSpotControl(currentModelNum,0);
      modelExploitV2(currentModelNum,nextModelAnim,false)
      $(".carousel-control-prev").removeAttr('data-slide');
      $(".carousel-control-next").removeAttr('data-slide');
      setTimeout(()=>{
      $(".carousel-control-prev").attr('data-slide','prev');
      $(".carousel-control-next").attr('data-slide','next');
      materialXuanHuiPoSuiJiChangeAoTexture(false)
      materialZhiShaJiChangeAoTexture(false)
      materialYuanZhuiPoSuiJiChangeAoTexture(false)
      },1500)
      $('#imageIntroductionBox').css("visibility","visible");
     
    // mouseEvenTimeOut = false
    }
})

function inithtml(){
  id = localStorage.getItem("id")
      checkitem();
      changeImgSrc(id-1);
      clickEvent(id);
      $("#icon"+id).attr('src',icon2path[id-1]);
}

    // $(document).ready(function () {
    //  // initscene();
    //   id = localStorage.getItem("id")
    //   checkitem();
    //   changeImgSrc(id-1);
    //   clickEvent(id);
    //   $("#icon"+id).attr('src',icon2path[id-1]);

    // });

    function checkitem() {
      // check function
      var $this = $("#myCarousel");

      if ($(".carousel-inner .carousel-item:first").hasClass("active")) {
        $(".carousel-control-prev").css("opacity",0.2)
        $(".carousel-control-next").css("opacity",1)
  
      } else if ($(".carousel-inner .carousel-item:last").hasClass("active")) {
        $(".carousel-control-prev").css("opacity",1)
        $(".carousel-control-next").css("opacity",0.2)
 
      } else {
        $(".carousel-control-prev").css("opacity",1)
        $(".carousel-control-next").css("opacity",1)
      }
    }

    function changeImgSrc(arg){
      //$("#imgId").attr('src',imgpath[arg]);
      if(arg!=3){
        $("#imgId").attr('src',modelIntroImgPath[currentModelNum][arg]);
      let activecam1 = scene.getCameraByID("Camera")
      let animCamera = animationChangeArr[currentModelNum][arg]
        cameraArcRotateAnimate(activecam1, ...animCamera.cameraAnimTargetNormolPosition, ...animCamera.cameraAnimNormolPosition)
      }
      else{
        $('#imageIntroductionBox').css("visibility","hidden");
        modelExploitV2(currentModelNum,nextModelAnim,true)
       
        $(".carousel-control-prev").removeAttr('data-slide');
      $(".carousel-control-next").removeAttr('data-slide');
      setTimeout(()=>{
      $(".carousel-control-prev").attr('data-slide','prev');
      $(".carousel-control-next").attr('data-slide','next');
      hotSpotControl(currentModelNum,1);
      },1500)
      materialXuanHuiPoSuiJiChangeAoTexture(true)
      materialZhiShaJiChangeAoTexture(true)
      materialYuanZhuiPoSuiJiChangeAoTexture(true)
      }

    }
    function clickEvent(args){
      nextModelNum = currentModelNum;
      currentModelNum = args-1;
      if(currentModelNum != nextModelNum){
     // currentModelNum = args-1
    // materialXuanHuiPoSuiJiChangeAoTexture(false)
    hotSpotControl(0,0);
    hotSpotControl(1,0);
    hotSpotControl(2,0);
      materialXuanHuiPoSuiJiChangeAoTexture(false)
      materialZhiShaJiChangeAoTexture(false)
      materialYuanZhuiPoSuiJiChangeAoTexture(false)
      changeImgSrc(0);
      $('.carousel').carousel(0)
      $('#imageIntroductionBox').css("visibility","visible");
     // modelExploit(nextModelAnim)
      for(let i =1;i<iconpath.length+1;i++){
             if(i==args){
              $("#icon"+i).attr('src',icon2path[i-1]);
             }
             else{
              $("#icon"+i).attr('src',iconpath[i-1]);
             }
      }
      }

    }
  </script>
  
  <script src="script/controlscript/modelcontrol.js"></script>
  <script src="script/controlscript/cameracontrol.js"></script>
  <script src="script/controlscript/svganim.js"></script>
</html>
